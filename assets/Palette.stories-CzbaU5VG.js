import{B as T,D as m}from"./Utils-DOz9aA_P.js";import $ from"./PaletteAPIdoc-DCX9Z7Nv.js";import"./iframe-hvrkV3Yv.js";import"./preload-helper-DLLWEBaG.js";const v=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],E=[0,60,120,180,240,300],M=["red","yellow","green","cyan","blue","purple"],w=M.reduce((p,t,r)=>(p[t]=E[r],p),{}),C=new Map;for(let p=0;p<v.length;p++)C.set(p,v[p]);class b{static normalizeCircular(t){return(t%360+360)%360}static getRandomNum(t,r){let a=[t,r].sort((e,o)=>e-o);return Math.floor(Math.random()*(a[1]-a[0]+1))+a[0]}static randomDigit(){return Math.floor(Math.random()*15)+1}static randomHexColor(){let t="#";for(let r=0;r<6;r++)t+=C.get(b.randomDigit());return t}static tohexDigits(t){let r=t.map(a=>Array.from(C.values()).indexOf(a.toLowerCase()));return r[0]*16+r[1]}static circular_distance(t,r){const a=Math.abs(t-r);return Math.min(a,360-a)}static luminance(t){let[r,a,e]=t.replace(/[rgb()\s+]/g,"").split(",");return(.2126*r+.7152*a+.0722*e)/255}}var x={colorCounts:1,alpha:1,colorMode:"hex",style:"random",tone:M[b.getRandomNum(0,5)],offset:10,saturationFixed:!1,lightnessFixed:!1};function S(p=x){let t=Object.assign({},x,p),r=t.colorMode,a=R(t);switch(r){case"hex":return a.map(e=>e.toHex());case"rgb":return a.map(e=>e.toRgb());default:return a.map(e=>e.toHsl())}}function R({colorCounts:p,alpha:t,style:r,tone:a,offset:e,saturationFixed:o,lightnessFixed:l}){let c=[],s=w[a];for(let d=0;d<p;d++){let i=P(r,s),h=B(o),n=O(l),u=new D(i,h,n,t);c.push(u)}return c.sort(function(d,i){let h=116*Math.pow((d.luminance+.055)/1.055,2)-16;return 116*Math.pow((i.luminance+.055)/1.055,2)-16-h})}function P(p,t,r){function a(e){let o;switch(e){case"contrast":o=t+b.getRandomNum(120,240);break;case"same":o=t+b.getRandomNum(-30,30);break;default:o=b.getRandomNum(0,359);break}return b.normalizeCircular(o)}return a(p)}function B(p=!1){return typeof p=="number"?p:b.getRandomNum(20,90)}function O(p=!1){return typeof p=="number"?p:b.getRandomNum(20,90)}class D{constructor(t,r,a,e){this.base={h:t,s:r,l:a,a:e},this.luminance=b.luminance(this.toRgb())}toRgb(){return k.hslTorgb(this.toHsl())}toHex(){return k.hslTohex(this.toHsl())}toHsl(){let{h:t,s:r,l:a,a:e}=this.base;return e!==1?`hsl(${t} ${r} ${a} / ${e})`:`hsl(${t} ${r} ${a})`}}class k{static hexTorgb(t){let r="";const a=Array.from(t.slice(1,3)),e=Array.from(t.slice(3,5)),o=Array.from(t.slice(5,7)),l=Array.from(t.slice(7,9));let c=b.tohexDigits(a),s=b.tohexDigits(e),d=b.tohexDigits(o),i=Math.round(b.tohexDigits(l)/255*100)/100;return i==1?r=`rgb(${c},${s},${d})`:r=`rgb(${c},${s},${d},${i})`,r}static rgbTohsl(t){let a=t.toLowerCase().replace(/[rgb()\s+]/g,"").split(",").map(f=>Math.round(f/255*100)/100),[e,o,l,c]=a,s=Math.max(...a),d=Math.min(...a),i=s-d,h,n,u,g;return s===d?h=0:s==e&&o>=l?h=60*((o-l)/i)+0:s==e&&o<l?h=60*((o-l)/i)+360:s==o?h=60*((l-e)/i)+120:s==l&&(h=60*((e-o)/i)+240),u=Math.round((s+d)/2*100)/100,u==0||s==d?n=0:u>0&&u<=.5?n=Math.round(Math.abs(i/(2*u))*100):u>.5&&(n=Math.round(Math.abs(i/(2-2*u))*100)),n=n>100?100:n,u=u*100>100?100:u*100,g=c||1,g!==1?`hsl(${Math.round(h)},${n}%,${u}%/${g})`:`hsl(${Math.round(h)},${n}%,${u}%)`}static hslTorgb(t){let r=t.toLowerCase().replace(/[hsl()/+]/g,"").replace(/\s+/g,",").split(","),[a,e,o,l]=r;a=(a%360+360)%360,e=parseInt(e)/100,o=parseInt(o)/100;const c=(1-Math.abs(2*o-1))*e,s=a/60,d=c*(1-Math.abs(s%2-1));let i=0,h=0,n=0;0<=s&&s<1?[i,h,n]=[c,d,0]:1<=s&&s<2?[i,h,n]=[d,c,0]:2<=s&&s<3?[i,h,n]=[0,c,d]:3<=s&&s<4?[i,h,n]=[0,d,c]:4<=s&&s<5?[i,h,n]=[d,0,c]:5<=s&&s<6&&([i,h,n]=[c,0,d]);const u=o-c/2,g=Math.round((i+u)*255),f=Math.round((h+u)*255),y=Math.round((n+u)*255);return l&&l!==1?`rgb(${g},${f},${y},${l})`:`rgb(${g},${f},${y})`}static rgbTohex(t){return`#${t.replace(/[rgb()\s+]/g,"").split(",").map(e=>{e=parseFloat(e),e<1&&(e=Math.floor(e*255));let o=e%16;return`${C.get(Math.floor(e/16))}${C.get(o)}`}).join("")}`}static hslTohex(t){let r=k.hslTorgb(t);return k.rgbTohex(r)}}const L="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8%203.5V12.5M12.5%208H3.5'%20stroke='white'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";var F={limits:5,defaults:[]};class q extends T{constructor(t={}){const r=document.createElement("div");m.addClass(r,["color-picker"]),super(r),this._config=Object.assign({},F,t),this.defaultColors=[...this._config.defaults].slice(0,this._config.limits),this.colors=[...this.defaultColors],this.current=this.colors[0],this._picker=this._createPickerpanel(),this._init(),this._bindEvent()}get picker(){return this._picker}get _picked(){return k.rgbTohsl(this.current)}_init(){for(let a of this.defaultColors){const e=document.createElement("div");m.addClass(e,["color"]),e.style.backgroundColor=a,m.setAttribute(e,"colorpick",a),this.onevent(e,"click",o=>{const l=o.target.dataset.colorpick;m.addClass(this._picker,["visible"]),m.setAttribute(this._picker,"currentpick",l),this._paintCanvas(this._picker.querySelector("canvas"),k.rgbTohsl(l)),m.setProperty(this._picker,"--picker-bg",k.rgbTohsl(l)),m.setProperty(this._picker.querySelector(".hue-track"),"--hue",k.rgbTohsl(l).toLowerCase().replace(/[hsl()/+]/g,"").replace(/\s+/g,",").split(",")[0])}),this.getElem().appendChild(e)}m.addClass(this._picker,["picker"]);const t=document.createElement("button");t.type="button";const r=document.createElement("img");r.src=L,t.append(r),m.addClass(t,["btn","btn-sm","btn-primary","add-color-btn"]),this.getElem().appendChild(t),this._addBtn=t,this._picker.querySelector(".hue-track .picker-btn"),this._picker.querySelector(".alpha-track .picker-btn"),this._picker.querySelector(".color-track .picker-btn"),this.getElem().appendChild(this._picker),this._render()}_bindEvent(){const t=this._picker.querySelector(".color-track"),r=this._picker.querySelector(".hue-track"),a=this._picker.querySelector(".alpha-track"),e=this._picker.querySelector(".hue-track .picker-btn");this._picker.querySelector(".alpha-track .picker-btn"),this._picker.querySelector(".color-track .picker-btn");let o=1,l=1,c=0,s=1;this._addBtn&&this.onevent(this._addBtn,"click",d.bind(this)),this.onevent(t,"pointerdown",n=>{t.setPointerCapture(n.pointerId),h.call(this),n.preventDefault()}),this.onevent(r,"pointerdown",n=>{r.setPointerCapture(n.pointerId),h.call(this),n.preventDefault()}),this.onevent(a,"pointerdown",n=>{a.setPointerCapture(n.pointerId),h.call(this),n.preventDefault()}),this.onevent(t,"pointermove",n=>{const{left:u,top:g,width:f,height:y}=n.currentTarget.getBoundingClientRect();o=i((n.clientX-u)/f),l=i(1-(n.clientY-g)/y)}),this.onevent(r,"pointermove",n=>{const{left:u,top:g,width:f,height:y}=n.currentTarget.getBoundingClientRect();c=i((n.clientX-u)/f)*360}),this.onevent(a,"pointermove",n=>{const{left:u,top:g,width:f,height:y}=n.currentTarget.getBoundingClientRect();s=i((n.clientX-u)/f)}),this.onevent(t,"pointerup",n=>{h.call(this)}),this.onevent(r,"pointerup",n=>{h.call(this)}),this.onevent(a,"pointerup",n=>{h.call(this)});function d(){m.toggleClass(this._picker,["visible"])}function i(n,u=0,g=1){return Math.min(g,Math.max(u,n))}function h(){console.log(o,l,c,s);const n=`hsl(${Math.round(c)},${Math.round(o*100)},${Math.round(l*100)})`;this.current=k.hslTorgb(n),console.log("update",this),this._paintCanvas(t.querySelector("canvas"),n),m.setProperty(e,"--hue",c),e.style.left=c/360*r.offsetWidth+"px",m.setProperty(this._picker,"--picker-bg",this.current)}}_render(){this.colors.length>this._config.limits&&m.addClass(this._addBtn,["hidden"])}_createPickerpanel(){const t=document.createElement("div"),r=document.createElement("div"),a=document.createElement("canvas"),e=document.createElement("div"),o=document.createElement("div");m.addClass(o,["current-picked-color"]),m.setAttribute(t,"currentpick",this._picked),this._paintCanvas(a,this._picked);const l=document.createElement("button"),c=document.createElement("button"),s=document.createElement("button"),d=document.createElement("div"),i=document.createElement("div");return r.append(a,l),d.append(s),i.append(c),e.append(o,i,d),t.append(r,e),m.addClass(r,["color-track"]),m.addClass(d,["alpha-track"]),m.addClass(i,["hue-track"]),m.addClass(l,["picker-btn"]),m.addClass(c,["picker-btn"]),m.addClass(s,["picker-btn"]),t}_paintCanvas(t,r){const a=t.width,e=t.height,o=t.getContext("2d");o.fillStyle=`hsl(${r.toLowerCase().replace(/[hsl()/+]/g,"").replace(/\s+/g,",").split(",")[0]},100%,50%)`,console.log(r),o.fillRect(0,0,a,e);const l=o.createLinearGradient(0,0,a,0);l.addColorStop(0,"rgba(255,255,255,1)"),l.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=l,o.fillRect(0,0,a,e);const c=o.createLinearGradient(0,e,0,0);c.addColorStop(0,"rgba(0,0,0,1)"),c.addColorStop(1,"rgba(0,0,0,0)"),o.fillStyle=c,o.fillRect(0,0,a,e)}_update(){}}const A=({colorCounts:p,colorMode:t,alpha:r,style:a,tone:e,offset:o,saturationFixed:l,lightnessFixed:c,saturation:s,lightness:d})=>{let i=document.createElement("div");i.className="flex";const n=S({colorCounts:p,colorMode:t,alpha:r,style:a,tone:e||"red",offset:o,saturationFixed:l&&s,lightnessFixed:c&&d});for(let f=0;f<p;f++){const y=document.createElement("div");y.style.width="30px",y.style.height="30px",y.style.backgroundColor=n[f],i.appendChild(y)}var u={limits:5,defaults:[...n.slice(0,3)]};const g=new q(u);return console.log(g),i.appendChild(g.getElem()),i},{fn:V,expect:X}=__STORYBOOK_MODULE_TEST__,{action:j}=__STORYBOOK_MODULE_ACTIONS__,U={title:"Components/Palette",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:$}},render:({...p})=>A({...p}),argTypes:{colorCounts:{control:{type:"number",min:1},type:{required:!0},description:"表格元素id",table:{category:"configurations",type:{summary:"number"}}},colorMode:{control:"select",description:"色碼模式",options:["hex","rgb","hsl"],table:{category:"configurations",defaultValue:{summary:"-"},type:{summary:"string"}}},style:{control:"select",options:["random","same","contrast"],description:"色系樣式",table:{category:"configurations",defaultValue:{summary:"random"},type:{summary:"string"}}},tone:{control:"select",options:["red","yellow","green","cyan","blue","purple"],description:"指定色系",table:{category:"configurations",defaultValue:{summary:"null"},type:{summary:"string"}}},offset:{control:{type:"number",min:1},description:"偏移量",table:{category:"configurations",defaultValue:{summary:"-"},type:{summary:"number"}}},alpha:{control:{type:"number",min:0,max:1},description:"透明度",table:{category:"configurations",defaultValue:{summary:"1"},type:{summary:"number"}}},saturationFixed:{control:"boolean",description:"是否固定飽和度",table:{category:"configurations",defaultValue:{summary:"false"},type:{summary:"number | boolean"}}},saturation:{if:{arg:"saturationFixed",truthy:!0},control:{type:"number",min:0,max:100},description:"飽和度固定值",table:{category:"configurations",defaultValue:{summary:"random(20~90)"},type:{summary:"number"}}},lightnessFixed:{control:"boolean",description:"是否固定明度",table:{category:"configurations",defaultValue:{summary:"false"},type:{summary:"number | boolean"}}},lightness:{if:{arg:"lightnessFixed",truthy:!0},control:{type:"number",min:0,max:100},description:"明度固定值",table:{category:"configurations",defaultValue:{summary:"random(20~90)"},type:{summary:"number"}}}},args:{colorCounts:1,colorMode:"hsl",alpha:1,style:"random",offset:10,tone:"red",saturationFixed:!1,lightnessFixed:!1}},_={args:{colorCounts:10,colorMode:"hsl",style:"random",alpha:1,offset:20,saturationFixed:!1,lightnessFixed:!0,saturation:90,lightness:70}};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  args: {
    colorCounts: 10,
    colorMode: 'hsl',
    style: 'random',
    alpha: 1,
    offset: 20,
    saturationFixed: false,
    lightnessFixed: true,
    saturation: 90,
    lightness: 70
  }
  // play: async ({ args, canvas, userEvent }) => {
  //   await userEvent.type(canvas.getByText('一般勾選框'), '勾選框');
  //   await userEvent.click(canvas.getByLabelText('一般勾選框'));
  //   await expect(args.handlers).toHaveBeenCalled();
  // }
}`,..._.parameters?.docs?.source}}};const Y=["Palette"];export{_ as Palette,Y as __namedExportsOrder,U as default};
