import{B as y}from"./Utils-DnITNN2a.js";import{D as v}from"./Dropdown-BNQcpUAE.js";import I from"./CardsAPIdoc-BfelvwbU.js";import"./iframe-CZpOUhof.js";import"./preload-helper-D9Z9MdNV.js";class k extends y{constructor(e,t){let s=document.createElement("div");s.classList.add("card"),s.innerHTML=` <div class="card-header">
            <div class="data-title">${e}</div>
            <div class="flex flex-row-reverse">
              <button type="button" class="closeBtn btn icon-btn text-btn" data-modal-target="close-data-modal">
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </button>
              <button type="button" class="miniBtn btn icon-btn text-btn" >
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>

              </button>
            </div>     
        </div>`,super(s),this.UItype="Card",this.cardContainer=this._elem,this.title=e,this._cardsize=this._setCardSize(t),this.minimize=!1,this._bindEvent()}_setCardSize(e){switch(e){case 2:return this.cardContainer.classList.add("md:col-span-2"),"2-col";case 3:return this.cardContainer.classList.add("md:col-span-3"),"full-col";default:return"1-col"}}_bindEvent(){this.cardContainer.querySelector(".miniBtn").addEventListener("click",e.bind(this));function e(){this.minimize=!this.minimize,this.cardContainer.dataset.minimize=this.minimize?"mini":"expand";let t=this.minimize?`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4h4m0 0v4m0-4-5 5M8 20H4m0 0v-4m0 4 5-5"/>
</svg>`:`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>`;this.cardContainer.querySelector(".miniBtn").innerHTML=t}}}class C extends k{constructor(e,t,s=1){super(e,s),this._infoStruct=new _(t),this.infoList=this._infoStruct.rows,this.blocks=[],this._contentBlock=document.createElement("div"),this._init()}_createBlock(e){let t=document.createElement("div");if(t.classList.add("row-block"),e.blockId&&(t.id=e.blockId),e.label){let s=document.createElement("div");if(e.blockclass&&s.classList.add(...e.blockclass),Array.isArray(e.label))e.label.forEach((n,a)=>{const l=document.createElement("span");if(l.textContent=n,l.classList.add("card-label"),s.appendChild(l),e.value?.[a]){const i=document.createElement("span");i.textContent=e.value[a],e.valueId?.[a]&&(i.id=e.valueId[a]),s.appendChild(i)}});else{const n=document.createElement("span");if(n.textContent=e.label,n.classList.add("card-label"),s.appendChild(n),e.value){const a=document.createElement("span");a.textContent=e.value,e.valueId&&(a.id=e.valueId),s.appendChild(a)}}e.customInner&&e.customInner.forEach(n=>{if(n instanceof HTMLElement)s.appendChild(n);else{let a=document.createElement("div");a.innerHTML=n,s.appendChild(a)}}),t.appendChild(s)}if(e.customInner&&!e.label&&e.customInner.forEach(s=>{if(s instanceof HTMLElement)e.blockclass&&s.classList.add(...e.blockclass),t.appendChild(s);else{let n=document.createElement("div");n.innerHTML=s,e.blockclass&&n.classList.add(...e.blockclass),t.appendChild(n)}}),e.btn){const s=document.createElement("div");s.classList.add("card-buttons"),e.btngroupClass?s.classList.add(...e.btngroupClass.split(" ")):e.blockclass&&!e.label&&s.classList.add(...e.blockclass),e.btn.forEach(n=>{const a=document.createElement("button");a.classList.add("btn"),a.textContent=n.text,n.class&&a.classList.add(...n.class),n.handler&&a.addEventListener("click",n.handler.bind(this)),n.id&&(a.id=n.id),s.appendChild(a)}),t.appendChild(s)}return t}_init(){this._contentBlock.className="card-data-content",this._render()}_render(){this.clearBlocks();const e=new Map;this.infoList.forEach(t=>{if(t._groupId)e.has(t._groupId)||e.set(t._groupId,[]),e.get(t._groupId).push(t);else{if(t._visible===!1)return;const s=this._createBlock(t);this.blocks.push(s),this._contentBlock.appendChild(s)}}),e.forEach((t,s)=>{const n=document.createElement("div");n.id=s,t.forEach(a=>{if(a._visible===!1)return;const l=this._createBlock(a);n.appendChild(l)}),this._contentBlock.appendChild(n),this.blocks.push(n)}),this.cardContainer.appendChild(this._contentBlock)}addBlocks(e,t={}){this._infoStruct.add(e,t),this.infoList=this._infoStruct.rows,this._render()}clearBlocks(){if(this._contentBlock.children){for(;this._contentBlock.firstChild;)this._contentBlock.firstChild.remove();this.blocks=[]}}deleteBlock(e){this._infoStruct.delete(e),this.infoList=this._infoStruct.rows,this._render()}toggleBlock(e){this._infoStruct.toggle(e),this.blocks.forEach(t=>{t.id===e&&t.classList.add("hidden")})}}class _{constructor(e){this.originInfos=this._wrapInfos(e),this.rowNum=e.length,this.rows=[],this._init()}_init(){this.rows=[];for(let e=0;e<this.rowNum;e++){const t={blockId:this.getInfoKeys("blockId")[e]||null,blockclass:this.getInfoKeys("blockClass")[e]||null,label:this.getInfoKeys("label")[e]||null,value:this.getInfoKeys("value")[e]||null,valueId:this.getInfoKeys("valueId")[e]||null,customInner:this.getInfoKeys("customInner")[e]||[],btn:Array.isArray(this.getInfoKeys("btn"))?this.getInfoKeys("btn")[e]:this.getInfoKeys("btn"),btngroupClass:this.getInfoKeys("btngroupClass")[e]};this.rows.push(t)}}_wrapInfos(e){return{blockId:e.map(s=>s.blockId||""),label:e.map(s=>s.label||""),blockClass:e.map(s=>s.blockclass||""),value:e.map(s=>s.value||""),valueId:e.map(s=>s?.valueId||""),customInner:e.map(s=>s.customInner?Array.isArray(s.customInner)?s.customInner:[s.customInner]:[]),btn:e.map(s=>s.btn),btngroupClass:e.map(s=>s.btngroupClass)}}getInfoKeys(e){return this.originInfos[e]}add(e,{once:t=!1,id:s}={}){const n=this._wrapInfos(e),a=e.map((l,i)=>({blockId:l.blockId||null,blockclass:n.blockClass[i]||null,label:n.label[i]||null,value:n.value[i]||null,valueId:n.valueId[i]||null,customInner:n.customInner[i]||null,btn:Array.isArray(n.btn)?n.btn[i]:n.btn,btngroupClass:n.btngroupClass[i],_groupId:s||null}));if(t){if(!s){console.error("once 模式需要提供 id");return}this.rows=this.rows.filter(l=>l._groupId!==s)}this.rows.push(...a),this.originInfos=this._wrapInfos(this.rows),this.rowNum=this.rows.length}delete(e){let t=this.getInfoKeys("label").findIndex(s=>s.includes(e));if(t<0){if(t=this.getInfoKeys("blockId").findIndex(s=>s===e),t<0){console.error("沒有對應的block");return}}else if(Array.isArray(this.getInfoKeys("label")[t])){let s=this.getInfoKeys("label")[t].findIndex(n=>n.includes(e));this.getInfoKeys("label")[t]=this.getInfoKeys("label")[t].filter((n,a)=>a!==s),this.getInfoKeys("value")[t]=this.getInfoKeys("value")[t].filter((n,a)=>a!==s),this.getInfoKeys("label")[t].length===1?(this.getInfoKeys("label")[t]=this.getInfoKeys("label")[t].toString(),this.getInfoKeys("value")[t]=this.getInfoKeys("value")[t].toString(),this.rows[t].label=this.getInfoKeys("label")[t],this.rows[t].value=this.getInfoKeys("value")[t]):(this.rows[t].label=this.getInfoKeys("label")[t].filter((n,a)=>a!==s),this.rows[t].value=this.getInfoKeys("value")[t].filter((n,a)=>a!==s))}else{for(let s in this.originInfos)this.originInfos[s]=this.originInfos[s].filter((n,a)=>a!==t);this.rowNum=this.rowNum-1,this.rows=this.rows.filter((s,n)=>n!==t)}console.log("after delete:",this.originInfos)}clear(){this.originInfos={},this.rowNum=0,this.rows=[]}toggle(e){this.rows.forEach(t=>{t._visible,t._groupId===e&&(t._visible=!1)})}}class x{constructor({labels:e,legends:t}){this.labels=e,this.legends=t,this.container=document.createElement("div"),this._init()}_init(){this.entries=Object.fromEntries(this.labels.map((e,t)=>[e,this.legends[t]])),this._render()}_render(){for(let e in this.entries){let t=document.createElement("div"),s=document.createElement("span"),n=document.createElement("p");n.textContent=e,s.classList.add("inline-block","w-6","h-5","border-gray-700"),s.classList.add(this.entries[e]),t.classList.add("flex","gap-2","items-center"),t.appendChild(s),t.appendChild(n),this.container.appendChild(t)}}}let E=new x({labels:["a","b","c"],legends:["bg-red-700","bg-green-500","bg-blue-500"]});console.log(E);const L=({blockId:r,blockclass:e,label:t,value:s,customInner:n,title:a,cardSize:l,btn:i,text:d,handlers:u,btngroupClass:h,...p})=>{const m=new v("ex_drop",[{value:1,text:"One"},{value:2,text:"Two"},{value:3,text:"Three"}]);function b(){alert("查看更多 clicked!")}let c=document.createElement("div");c.className="grid grid-cols-3",i=[{text:d,class:p.class,handlers:u}];let g=[{blockId:r,blockclass:[...e],label:[t,"price: "],value:[s,"$1,000"],customInner:n,btn:i,btngroupClass:h},{blockclass:["mt-3"],label:"配合其他元件作為customInner :",customInner:m.containerEl},{btn:[{text:"查看更多",class:["btn-primary"],handler:b}],btngroupClass:"mt-3"}],f=new C(a,g,l);return c.appendChild(f.cardContainer),c},{fn:T,expect:A}=__STORYBOOK_MODULE_TEST__,{action:z}=__STORYBOOK_MODULE_ACTIONS__,H={title:"Components/Infocards",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:I}},render:({...r})=>L({...r}),argTypes:{cardSize:{control:"select",options:[1,2,3],description:"卡片尺寸大小",table:{category:"parameters",subcategory:"Inherits Card 類別",defaultValue:{summary:"1"},type:{summary:"number"}}},infoList:{control:"array",description:"傳入之資料欄位設定，請參考上方Info porperties",table:{readonly:!0,category:"parameters",subcategory:"Inherits Info 類別",type:{summary:"array"}}},title:{control:"text",description:"卡片標題文字",table:{category:"parameters",subcategory:"Inherits Card 類別",type:{summary:"string"}}},blockId:{control:"text",description:"區塊指定id",table:{category:"infoList poperties",type:{summary:"string"}}},blockclass:{control:"array",description:"區塊classes",table:{category:"infoList poperties",type:{summary:"array"}}},label:{control:"text",description:"資料標題",table:{category:"infoList poperties",type:{summary:"string"}}},value:{control:"text",description:"資料內容",table:{category:"infoList poperties",type:{summary:"string"}}},customInner:{control:"text",description:"自訂innerHTML內容，可以取代value屬性",table:{category:"infoList poperties",type:{summary:"string"}}},btn:{control:"function",description:"所有按鈕設定",table:{readonly:!0,category:"infoList poperties",type:{summary:"array"}}},text:{control:{type:"text"},if:{arg:"btn",exists:!0},description:"按鈕文字",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"checkbox"},type:{summary:"string"}}},class:{control:{type:"array"},if:{arg:"btn",exists:!0},description:"checkbox classes，每個class以tailwindcss property放入",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"checkbox"},type:{summary:"array"}}},handlers:{action:"change",control:"function",if:{arg:"btn",exists:!0},description:"作為click事件函式傳入",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"function"}}},btngroupClass:{control:"text",description:"按鈕群組樣式(如果沒有特別設定則是吃blockClass)",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"string"}}}},args:{label:"資料欄位A",value:"資料A"}},o={args:{blockId:"testing",blockclass:["gap-3"],label:"資料欄位A: ",value:"資料內容A",customInner:'<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>',title:"測試面板",cardSize:1,btn:[],text:"開始查詢",class:["btn-secondary"],btngroupClass:"flex flex-nowrap ml-2"}};o.parameters={...o.parameters,docs:{...o.parameters?.docs,source:{originalSource:`{
  args: {
    blockId: "testing",
    blockclass: ["gap-3"],
    label: "資料欄位A: ",
    value: "資料內容A",
    customInner: \`<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>\`,
    title: "測試面板",
    //文字
    cardSize: 1,
    btn: [],
    text: "開始查詢",
    class: ["btn-secondary"],
    btngroupClass: "flex flex-nowrap ml-2"
  }
  // play: async ({ args, canvas, userEvent }) => {
  //   await userEvent.type(canvas.getByText('一般勾選框'), '勾選框');
  //   await userEvent.click(canvas.getByLabelText('一般勾選框'));
  //   await expect(args.handlers).toHaveBeenCalled();
  // }
}`,...o.parameters?.docs?.source}}};const O=["defaultInfocard"];export{O as __namedExportsOrder,H as default,o as defaultInfocard};
