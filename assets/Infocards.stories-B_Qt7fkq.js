import{B as y}from"./Utils-MIAVsKBh.js";import{D as v}from"./Dropdown-BZYj9lL9.js";import I from"./CardsAPIdoc-MtPaB3FJ.js";import"./index-vRTWSlA6.js";import"./iframe-BsY5FQ7T.js";import"./preload-helper-DLLWEBaG.js";class k extends y{constructor(t,e){let s=document.createElement("div");s.classList.add("card"),s.innerHTML=` <div class="card-header">
            <div class="data-title">${t}</div>
            <div class="flex flex-row-reverse">
              <button type="button" class="closeBtn btn icon-btn text-btn" data-modal-target="close-data-modal">
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </button>
              <button type="button" class="miniBtn btn icon-btn text-btn" >
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>

              </button>
            </div>     
        </div>`,super(s),this.UItype="Card",this.cardContainer=this._elem,this.title=t,this._cardsize=this._setCardSize(e),this.minimize=!1,this._bindEvent()}_setCardSize(t){switch(t){case 2:return this.cardContainer.classList.add("md:col-span-2"),"2-col";case 3:return this.cardContainer.classList.add("md:col-span-3"),"full-col";default:return"1-col"}}_bindEvent(){this.onevent(this.cardContainer.querySelector(".miniBtn"),"click",t.bind(this));function t(){this.minimize=!this.minimize,this.cardContainer.dataset.minimize=this.minimize?"mini":"expand";let e=this.minimize?`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4h4m0 0v4m0-4-5 5M8 20H4m0 0v-4m0 4 5-5"/>
</svg>`:`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>`;this.cardContainer.querySelector(".miniBtn").innerHTML=e}}}class C extends k{constructor(t,e,s=1){super(t,s),this._infoStruct=new _(e),this.infoList=this._infoStruct.rows,this.blocks=[],this._contentBlock=document.createElement("div"),this._init()}_createBlock(t){let e=document.createElement("div");if(e.classList.add("row-block"),t.blockId&&(e.id=t.blockId),t.label){let s=document.createElement("div");if(t.blockclass&&s.classList.add(...t.blockclass),Array.isArray(t.label))t.label.forEach((n,a)=>{const l=document.createElement("span");if(l.textContent=n,l.classList.add("card-label"),s.appendChild(l),t.value?.[a]){const i=document.createElement("span");i.textContent=t.value[a],t.valueId?.[a]&&(i.id=t.valueId[a]),s.appendChild(i)}});else{const n=document.createElement("span");if(n.textContent=t.label,n.classList.add("card-label"),s.appendChild(n),t.value){const a=document.createElement("span");a.textContent=t.value,t.valueId&&(a.id=t.valueId),s.appendChild(a)}}t.customInner&&t.customInner.forEach(n=>{if(n instanceof HTMLElement)s.appendChild(n);else{let a=document.createElement("div");a.innerHTML=n,s.appendChild(a)}}),e.appendChild(s)}if(t.customInner&&!t.label&&t.customInner.forEach(s=>{if(s instanceof HTMLElement)t.blockclass&&s.classList.add(...t.blockclass),e.appendChild(s);else{let n=document.createElement("div");n.innerHTML=s,t.blockclass&&n.classList.add(...t.blockclass),e.appendChild(n)}}),t.btn){const s=document.createElement("div");s.classList.add("card-buttons"),t.btngroupClass?s.classList.add(...t.btngroupClass.split(" ")):t.blockclass&&!t.label&&s.classList.add(...t.blockclass),t.btn.forEach(n=>{const a=document.createElement("button");a.classList.add("btn"),a.textContent=n.text,n.class&&a.classList.add(...n.class),n.handler&&a.addEventListener("click",n.handler.bind(this)),n.id&&(a.id=n.id),s.appendChild(a)}),e.appendChild(s)}return e}_init(){this._contentBlock.className="card-data-content",this._render()}_render(){this.clearBlocks();const t=new Map;this.infoList.forEach(e=>{if(e._groupId)t.has(e._groupId)||t.set(e._groupId,[]),t.get(e._groupId).push(e);else{if(e._visible===!1)return;const s=this._createBlock(e);this.blocks.push(s),this._contentBlock.appendChild(s)}}),t.forEach((e,s)=>{const n=document.createElement("div");n.id=s,e.forEach(a=>{if(a._visible===!1)return;const l=this._createBlock(a);n.appendChild(l)}),this._contentBlock.appendChild(n),this.blocks.push(n)}),this.cardContainer.appendChild(this._contentBlock)}addBlocks(t,e={}){this._infoStruct.add(t,e),this.infoList=this._infoStruct.rows,this._render()}clearBlocks(){if(this._contentBlock.children){for(;this._contentBlock.firstChild;)this._contentBlock.firstChild.remove();this.blocks=[]}}deleteBlock(t){this._infoStruct.delete(t),this.infoList=this._infoStruct.rows,this._render()}toggleBlock(t){this._infoStruct.toggle(t),this.blocks.forEach(e=>{e.id===t&&e.classList.add("hidden")})}}class _{constructor(t){this.originInfos=this._wrapInfos(t),this.rowNum=t.length,this.rows=[],this._init()}_init(){this.rows=[];for(let t=0;t<this.rowNum;t++){const e={blockId:this.getInfoKeys("blockId")[t]||null,blockclass:this.getInfoKeys("blockClass")[t]||null,label:this.getInfoKeys("label")[t]||null,value:this.getInfoKeys("value")[t]||null,valueId:this.getInfoKeys("valueId")[t]||null,customInner:this.getInfoKeys("customInner")[t]||[],btn:Array.isArray(this.getInfoKeys("btn"))?this.getInfoKeys("btn")[t]:this.getInfoKeys("btn"),btngroupClass:this.getInfoKeys("btngroupClass")[t]};this.rows.push(e)}}_wrapInfos(t){return{blockId:t.map(s=>s.blockId||""),label:t.map(s=>s.label||""),blockClass:t.map(s=>s.blockclass||""),value:t.map(s=>s.value||""),valueId:t.map(s=>s?.valueId||""),customInner:t.map(s=>s.customInner?Array.isArray(s.customInner)?s.customInner:[s.customInner]:[]),btn:t.map(s=>s.btn),btngroupClass:t.map(s=>s.btngroupClass)}}getInfoKeys(t){return this.originInfos[t]}add(t,{once:e=!1,id:s}={}){const n=this._wrapInfos(t),a=t.map((l,i)=>({blockId:l.blockId||null,blockclass:n.blockClass[i]||null,label:n.label[i]||null,value:n.value[i]||null,valueId:n.valueId[i]||null,customInner:n.customInner[i]||null,btn:Array.isArray(n.btn)?n.btn[i]:n.btn,btngroupClass:n.btngroupClass[i],_groupId:s||null}));if(e){if(!s){console.error("once 模式需要提供 id");return}this.rows=this.rows.filter(l=>l._groupId!==s)}this.rows.push(...a),this.originInfos=this._wrapInfos(this.rows),this.rowNum=this.rows.length}delete(t){let e=this.getInfoKeys("label").findIndex(s=>s.includes(t));if(e<0){if(e=this.getInfoKeys("blockId").findIndex(s=>s===t),e<0){console.error("沒有對應的block");return}}else if(Array.isArray(this.getInfoKeys("label")[e])){let s=this.getInfoKeys("label")[e].findIndex(n=>n.includes(t));this.getInfoKeys("label")[e]=this.getInfoKeys("label")[e].filter((n,a)=>a!==s),this.getInfoKeys("value")[e]=this.getInfoKeys("value")[e].filter((n,a)=>a!==s),this.getInfoKeys("label")[e].length===1?(this.getInfoKeys("label")[e]=this.getInfoKeys("label")[e].toString(),this.getInfoKeys("value")[e]=this.getInfoKeys("value")[e].toString(),this.rows[e].label=this.getInfoKeys("label")[e],this.rows[e].value=this.getInfoKeys("value")[e]):(this.rows[e].label=this.getInfoKeys("label")[e].filter((n,a)=>a!==s),this.rows[e].value=this.getInfoKeys("value")[e].filter((n,a)=>a!==s))}else{for(let s in this.originInfos)this.originInfos[s]=this.originInfos[s].filter((n,a)=>a!==e);this.rowNum=this.rowNum-1,this.rows=this.rows.filter((s,n)=>n!==e)}console.log("after delete:",this.originInfos)}clear(){this.originInfos={},this.rowNum=0,this.rows=[]}toggle(t){this.rows.forEach(e=>{e._visible,e._groupId===t&&(e._visible=!1)})}}class x{constructor({labels:t,legends:e}){this.labels=t,this.legends=e,this.container=document.createElement("div"),this._init()}_init(){this.entries=Object.fromEntries(this.labels.map((t,e)=>[t,this.legends[e]])),this._render()}_render(){for(let t in this.entries){let e=document.createElement("div"),s=document.createElement("span"),n=document.createElement("p");n.textContent=t,s.classList.add("inline-block","w-6","h-5","border-gray-700"),s.classList.add(this.entries[t]),e.classList.add("flex","gap-2","items-center"),e.appendChild(s),e.appendChild(n),this.container.appendChild(e)}}}let E=new x({labels:["a","b","c"],legends:["bg-red-700","bg-green-500","bg-blue-500"]});console.log(E);const L=({blockId:r,blockclass:t,label:e,value:s,customInner:n,title:a,cardSize:l,btn:i,text:d,handlers:u,btngroupClass:h,...p})=>{const m=new v("ex_drop",[{value:1,text:"One"},{value:2,text:"Two"},{value:3,text:"Three"}]);function b(){alert("查看更多 clicked!")}let c=document.createElement("div");c.className="grid grid-cols-3",i=[{text:d,class:p.class,handlers:u}];let g=[{blockId:r,blockclass:[...t],label:[e,"price: "],value:[s,"$1,000"],customInner:n,btn:i,btngroupClass:h},{blockclass:["mt-3"],label:"配合其他元件作為customInner :",customInner:m.containerEl},{btn:[{text:"查看更多",class:["btn-primary"],handler:b}],btngroupClass:"mt-3"}],f=new C(a,g,l);return c.appendChild(f.cardContainer),c},{fn:A,expect:z}=__STORYBOOK_MODULE_TEST__,{action:H}=__STORYBOOK_MODULE_ACTIONS__,O={title:"Components/Infocards",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:I}},render:({...r})=>L({...r}),argTypes:{cardSize:{control:"select",options:[1,2,3],description:"卡片尺寸大小",table:{category:"parameters",subcategory:"Inherits Card 類別",defaultValue:{summary:"1"},type:{summary:"number"}}},infoList:{control:"array",description:"傳入之資料欄位設定，請參考上方Info porperties",table:{readonly:!0,category:"parameters",subcategory:"Inherits Info 類別",type:{summary:"array"}}},title:{control:"text",description:"卡片標題文字",table:{category:"parameters",subcategory:"Inherits Card 類別",type:{summary:"string"}}},blockId:{control:"text",description:"區塊指定id",table:{category:"infoList poperties",type:{summary:"string"}}},blockclass:{control:"array",description:"區塊classes",table:{category:"infoList poperties",type:{summary:"array"}}},label:{control:"text",description:"資料標題",table:{category:"infoList poperties",type:{summary:"string"}}},value:{control:"text",description:"資料內容",table:{category:"infoList poperties",type:{summary:"string"}}},customInner:{control:"text",description:"自訂innerHTML內容，可以取代value屬性",table:{category:"infoList poperties",type:{summary:"string"}}},btn:{control:"function",description:"所有按鈕設定",table:{readonly:!0,category:"infoList poperties",type:{summary:"array"}}},text:{control:{type:"text"},if:{arg:"btn",exists:!0},description:"按鈕文字",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"string"}}},class:{control:{type:"array"},if:{arg:"btn",exists:!0},description:"checkbox classes，每個class以tailwindcss property放入",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"array"}}},handlers:{action:"change",control:"function",if:{arg:"btn",exists:!0},description:"作為click事件函式傳入",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"function"}}},btngroupClass:{control:"text",description:"按鈕群組樣式(如果沒有特別設定則是吃blockClass)",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"string"}}}},args:{label:"資料欄位A",value:"資料A"}},o={args:{blockId:"testing",blockclass:["gap-3"],label:"資料欄位A: ",value:"資料內容A",customInner:'<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>',title:"測試面板",cardSize:1,btn:[],text:"開始查詢",class:["btn-secondary"],btngroupClass:"flex flex-nowrap ml-2"}};o.parameters={...o.parameters,docs:{...o.parameters?.docs,source:{originalSource:`{
  args: {
    blockId: "testing",
    blockclass: ["gap-3"],
    label: "資料欄位A: ",
    value: "資料內容A",
    customInner: \`<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>\`,
    title: "測試面板",
    //文字
    cardSize: 1,
    btn: [],
    text: "開始查詢",
    class: ["btn-secondary"],
    btngroupClass: "flex flex-nowrap ml-2"
  }
  // play: async ({ args, canvas, userEvent }) => {
  //   await userEvent.type(canvas.getByText('一般勾選框'), '勾選框');
  //   await userEvent.click(canvas.getByLabelText('一般勾選框'));
  //   await expect(args.handlers).toHaveBeenCalled();
  // }
}`,...o.parameters?.docs?.source}}};const N=["defaultInfocard"];export{N as __namedExportsOrder,O as default,o as defaultInfocard};
