import{B as v,s as I,b as k}from"./Utils-DOz9aA_P.js";import{N as C}from"./Notification-CYZPDGjq.js";import{D as _}from"./Dropdown-FDjR_vQ8.js";import x from"./CardsAPIdoc-EdzekUmV.js";/* empty css                     *//* empty css                 *//* empty css                 */import"./index-vRTWSlA6.js";import"./iframe-BVS5Mtot.js";import"./preload-helper-DLLWEBaG.js";class L extends v{constructor(e,t){let s=document.createElement("div");s.classList.add("card"),s.innerHTML=` <div class="card-header">
            <div class="data-title">${e}</div>
            <div class="flex flex-row-reverse">
              <button type="button" class="closeBtn btn icon-btn text-btn" data-modal-target="close-data-modal">
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </button>
              <button type="button" class="miniBtn btn icon-btn text-btn" >
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>

              </button>
            </div>     
        </div>`,super(s),this.UItype="Card",this.cardContainer=this._elem,this.title=e,this._cardsize=this._setCardSize(t),this.minimize=!1,this._bindEvent()}_setCardSize(e){switch(e){case 2:return this.cardContainer.classList.add("md:col-span-2"),"2-col";case 3:return this.cardContainer.classList.add("md:col-span-3"),"full-col";default:return"1-col"}}_bindEvent(){this.onevent(this.cardContainer.querySelector(".miniBtn"),"click",e.bind(this));function e(){this.minimize=!this.minimize,this.cardContainer.dataset.minimize=this.minimize?"mini":"expand";let s=this.minimize?`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4h4m0 0v4m0-4-5 5M8 20H4m0 0v-4m0 4 5-5"/>
</svg>`:`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>`;this.cardContainer.querySelector(".miniBtn").innerHTML=s}this.cardContainer.querySelector(".closeBtn").addEventListener("click",t.bind(this));function t(){C.modal(this.cardContainer.querySelector(".closeBtn"),{msgContent:"確定關閉此資料區塊? 關閉後須重新查詢",placement:"center",confirm:["確定關閉",()=>{this.cardContainer.remove()}],cancel:"取消",backdropClasses:"bg-gray-800/50"})}}}class E extends L{constructor(e,t,s=1){super(e,s),this._infoStruct=new B(t),this.infoList=this._infoStruct.infos,this.blocks=[],this._contentBlock=document.createElement("div"),this._init()}_createBlock(e){let t=document.createElement("div");if(t.classList.add("row-block"),e.blockId&&(t.id=e.blockId),e.label){let s=document.createElement("div");if(e.blockclass&&s.classList.add(...e.blockclass),Array.isArray(e.label))e.label.forEach((i,n)=>{const l=document.createElement("span");if(l.textContent=i,l.classList.add("card-label"),s.appendChild(l),e.value?.[n]){const a=document.createElement("span");a.textContent=e.value[n],e.valueId?.[n]&&(a.id=e.valueId[n]),s.appendChild(a)}});else{const i=document.createElement("span");if(i.textContent=e.label,i.classList.add("card-label"),s.appendChild(i),e.value){const n=document.createElement("span");n.textContent=e.value,e.valueId&&(n.id=e.valueId),s.appendChild(n)}}e.customInner&&e.customInner.forEach(i=>{if(i instanceof HTMLElement)s.appendChild(i);else{let n=document.createElement("div");n.innerHTML=i,s.appendChild(n)}}),t.appendChild(s)}if(e.customInner&&!e.label&&e.customInner.forEach(s=>{if(s instanceof HTMLElement)e.blockclass&&s.classList.add(...e.blockclass),t.appendChild(s);else{let i=document.createElement("div");i.innerHTML=s,e.blockclass&&i.classList.add(...e.blockclass),t.appendChild(i)}}),e.btn){const s=document.createElement("div");s.classList.add("card-buttons"),e.btngroupClass?s.classList.add(...e.btngroupClass.split(" ")):e.blockclass&&!e.label&&s.classList.add(...e.blockclass),e.btn.forEach(i=>{const n=document.createElement("button");n.classList.add("btn"),n.textContent=i.text,i.class&&n.classList.add(...i.class),i.handler&&n.addEventListener("click",i.handler.bind(this)),i.id&&(n.id=i.id),s.appendChild(n)}),t.appendChild(s)}return t}_init(){this._contentBlock.className="card-data-content",this._render()}_render(){this.clearBlocks();const e=new Map;this.infoList.forEach(t=>{if(t._groupId)e.has(t._groupId)||e.set(t._groupId,[]),e.get(t._groupId).push(t);else{if(t._visible===!1)return;const s=this._createBlock(t);this.blocks.push(s),this._contentBlock.appendChild(s)}}),e.forEach((t,s)=>{const i=document.createElement("div");i.id=s,t.forEach(n=>{if(n._visible===!1)return;const l=this._createBlock(n);i.appendChild(l)}),this._contentBlock.appendChild(i),this.blocks.push(i)}),this.cardContainer.appendChild(this._contentBlock)}addBlocks(e,t={}){this._infoStruct.add(e,t),this.infoList=this._infoStruct.infos,this._render()}clearBlocks(){if(this._contentBlock.children){for(;this._contentBlock.firstChild;)this._contentBlock.firstChild.remove();this.blocks=[]}}deleteBlock(e){this._infoStruct.delete(e),this.infoList=this._infoStruct.infos,this._render()}toggleBlock(e){this._infoStruct.toggle(e),this.blocks.forEach(t=>{t.id===e&&t.classList.add("hidden")})}updateLabel(e,t){this._infoStruct.update(e,t),this.infoList=this._infoStruct.infos,this._render()}}class B{constructor(e){this.infoProps=this._wrapInfos(e),this.rowNum=e.length,this.infos=this._createInfoRows(e),this.uuid=I()}_init(){this.infos=[];for(let e=0;e<this.rowNum;e++){const t={blockId:this.getInfoKeys("blockId")[e]||null,blockclass:this.getInfoKeys("blockClass")[e]||null,label:this.getInfoKeys("label")[e]||null,value:this.getInfoKeys("value")[e]||null,valueId:this.getInfoKeys("valueId")[e]||null,customInner:this.getInfoKeys("customInner")[e]||[],btn:Array.isArray(this.getInfoKeys("btn"))?this.getInfoKeys("btn")[e]:this.getInfoKeys("btn"),btngroupClass:this.getInfoKeys("btngroupClass")[e]};this.infos.push(t)}}_wrapInfos(e){return e.reduce((t,s)=>(t.blockId.push(s.blockId||""),t.label.push(s.label||""),t.blockClass.push(s.blockclass||""),t.value.push(s.value||""),t.valueId.push(s?.valueId||""),t.customInner.push(s.customInner?Array.isArray(s.customInner)?s.customInner:[s.customInner]:[]),t.btn.push(s.btn),t.btngroupClass.push(s.btngroupClass),t),{blockId:[],label:[],blockClass:[],value:[],valueId:[],customInner:[],btn:[],btngroupClass:[]})}getInfoKeys(e){return this.infoProps[e]}_createInfoRows(e){const t=this._wrapInfos(e);return e.map((i,n)=>({blockId:i.blockId||null,blockclass:t.blockClass[n]||null,label:t.label[n]||null,value:t.value[n]||null,valueId:t.valueId[n]||null,customInner:t.customInner[n]||[],btn:Array.isArray(t.btn)?t.btn[n]:t.btn,btngroupClass:t.btngroupClass[n]}))}add(e,{once:t=!1,id:s}={}){const i=this._createInfoRows(e);if(i.forEach(n=>n._groupId=s||null),t){if(!s){console.error("once 模式需要提供 id");return}this.infos=this.infos.filter(n=>n._groupId!==s)}this.infos.push(...i),this.infoProps=this._wrapInfos(this.infos),this.rowNum=this.infos.length}delete(e){let t=this.getInfoKeys("label").findIndex(s=>s.includes(e));if(t<0){if(t=this.getInfoKeys("blockId").findIndex(s=>s===e),t<0){console.error("沒有對應的block");return}}else if(Array.isArray(this.getInfoKeys("label")[t])){let s=this.getInfoKeys("label")[t].findIndex(i=>i.includes(e));this.getInfoKeys("label")[t]=this.getInfoKeys("label")[t].filter((i,n)=>n!==s),this.getInfoKeys("value")[t]=this.getInfoKeys("value")[t].filter((i,n)=>n!==s),this.getInfoKeys("label")[t].length===1?(this.getInfoKeys("label")[t]=this.getInfoKeys("label")[t].toString(),this.getInfoKeys("value")[t]=this.getInfoKeys("value")[t].toString(),this.infos[t].label=this.getInfoKeys("label")[t],this.rows[t].value=this.getInfoKeys("value")[t]):(this.rows[t].label=this.getInfoKeys("label")[t].filter((i,n)=>n!==s),this.rows[t].value=this.getInfoKeys("value")[t].filter((i,n)=>n!==s))}else{for(let s in this.infoProps)this.infoProps[s]=this.infoProps[s].filter((i,n)=>n!==t);this.rowNum=this.rowNum-1,this.infos=this.infos.filter((s,i)=>i!==t)}console.log("after delete:",this.infoProps)}clear(){this.infoProps={},this.rowNum=0,this.infos=[]}toggle(e){this.infos.forEach(t=>{t._visible,t._groupId===e&&(t._visible=!1)})}update(e,t,s){if(k(e,"string")){const n=this.getInfoKeys("label"),l=this.getInfoKeys("value");let a=n.findIndex(r=>r.includes(e));if(a<0&&(a=this.getInfoKeys("blockId").findIndex(r=>r===e),a<0)){console.error("沒有對應的block");return}if(Array.isArray(n[a])){let r=n[a].findIndex(u=>u.includes(e));l[a][r]=t}else l[a]=t;this.infos[a].value=l[a]}else console.log(e,t,s)}}class K{constructor({labels:e,legends:t}){this.labels=e,this.legends=t,this.container=document.createElement("div"),this._init()}_init(){this.entries=Object.fromEntries(this.labels.map((e,t)=>[e,this.legends[t]])),this._render()}_render(){for(let e in this.entries){let t=document.createElement("div"),s=document.createElement("span"),i=document.createElement("p");i.textContent=e,s.classList.add("inline-block","w-6","h-5","border-gray-700"),s.classList.add(this.entries[e]),t.classList.add("flex","gap-2","items-center"),t.appendChild(s),t.appendChild(i),this.container.appendChild(t)}}}new K({labels:["a","b","c"],legends:["bg-red-700","bg-green-500","bg-blue-500"]});const S=({blockId:o,blockclass:e,label:t,value:s,customInner:i,title:n,cardSize:l,btn:a,text:r,handlers:u,btngroupClass:p,...b})=>{const f=new _("ex_drop",[{value:1,text:"One"},{value:2,text:"Two"},{value:3,text:"Three"}]);function m(){alert("查看更多 clicked!")}let h=document.createElement("div");h.className="grid grid-cols-3",a=[{text:r,class:b.class,handlers:u}];let g=[{blockId:o,blockclass:[...e],label:[t,"price: "],value:[s,"$1,000"],customInner:i,btn:a,btngroupClass:p},{blockclass:["mt-3"],label:"配合其他元件作為customInner :",customInner:f.containerEl},{btn:[{text:"查看更多",class:["btn-primary"],handler:m}],btngroupClass:"mt-3"}],c=new E(n,g,l);h.appendChild(c.cardContainer),console.log("realpriceCard:",c),c.updateLabel(t,"更新資料欄位內容A");const y=crypto.randomUUID();return c.addBlocks([{blockId:"testa",label:"統計範圍內(橘框虛線)建物資料數量：",value:1,btn:[{text:"btn01",class:["btn-primary"]},{text:"btn01",class:["btn-primary"]}],btngroupClass:"a b c"},{blockId:"testb",label:"平均屋齡：",value:2,blockclass:["test-class"]},{label:["最大值","最小值"],value:[2,3]},{blockclass:["flex","flex-col","tips-container","text-sm"],customInner:'<span>＊計算可能受到建築完成日未填寫影響，數據僅供參考</span><span>檢視屋齡分布可操作[交易安全]></span><a class="text-btn" href="javascript:overnav(555);">[建物屋齡模擬]</a>'}],{once:!0,id:y}),c.updateLabel("最大值",10),h},{fn:P,expect:R}=__STORYBOOK_MODULE_TEST__,{action:F}=__STORYBOOK_MODULE_ACTIONS__,j={title:"Components/Infocards",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:x}},render:({...o})=>S({...o}),argTypes:{cardSize:{control:"select",options:[1,2,3],description:"卡片尺寸大小",table:{category:"parameters",subcategory:"Inherits Card 類別",defaultValue:{summary:"1"},type:{summary:"number"}}},infoList:{control:"array",description:"傳入之資料欄位設定，請參考上方Info porperties",table:{readonly:!0,category:"parameters",subcategory:"Inherits Info 類別",type:{summary:"array"}}},title:{control:"text",description:"卡片標題文字",table:{category:"parameters",subcategory:"Inherits Card 類別",type:{summary:"string"}}},blockId:{control:"text",description:"區塊指定id",table:{category:"infoList poperties",type:{summary:"string"}}},blockclass:{control:"array",description:"區塊classes",table:{category:"infoList poperties",type:{summary:"array"}}},label:{control:"text",description:"資料標題",table:{category:"infoList poperties",type:{summary:"string"}}},value:{control:"text",description:"資料內容",table:{category:"infoList poperties",type:{summary:"string"}}},customInner:{control:"text",description:"自訂innerHTML內容，可以取代value屬性",table:{category:"infoList poperties",type:{summary:"string"}}},btn:{control:"function",description:"所有按鈕設定",table:{readonly:!0,category:"infoList poperties",type:{summary:"array"}}},text:{control:{type:"text"},if:{arg:"btn",exists:!0},description:"按鈕文字",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"string"}}},class:{control:{type:"array"},if:{arg:"btn",exists:!0},description:"checkbox classes，每個class以tailwindcss property放入",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"array"}}},handlers:{action:"change",control:"function",if:{arg:"btn",exists:!0},description:"作為click事件函式傳入",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"function"}}},btngroupClass:{control:"text",description:"按鈕群組樣式(如果沒有特別設定則是吃blockClass)",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"string"}}}},args:{label:"資料欄位A",value:"資料A"}},d={args:{blockId:"testing",blockclass:["gap-3"],label:"資料欄位A: ",value:"資料內容A",customInner:'<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>',title:"測試面板",cardSize:1,btn:[],text:"開始查詢",class:["btn-secondary"],btngroupClass:"flex flex-nowrap ml-2"}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    blockId: "testing",
    blockclass: ["gap-3"],
    label: "資料欄位A: ",
    value: "資料內容A",
    customInner: \`<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>\`,
    title: "測試面板",
    //文字
    cardSize: 1,
    btn: [],
    text: "開始查詢",
    class: ["btn-secondary"],
    btngroupClass: "flex flex-nowrap ml-2"
  }
  // play: async ({ args, canvas, userEvent }) => {
  //   await userEvent.type(canvas.getByText('一般勾選框'), '勾選框');
  //   await userEvent.click(canvas.getByLabelText('一般勾選框'));
  //   await expect(args.handlers).toHaveBeenCalled();
  // }
}`,...d.parameters?.docs?.source}}};const q=["defaultInfocard"];export{q as __namedExportsOrder,j as default,d as defaultInfocard};
