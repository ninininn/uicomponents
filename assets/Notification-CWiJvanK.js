import{M as y,P as v,a as g}from"./index-vRTWSlA6.js";import{a as b,U as i,B as d}from"./Utils-D4AxMvsK.js";class h{static toast(t,e={}){let s=new p(t,e);return e.handler&&t.addEventListener("click",b(e.handler,500)),s.pushItem(e)}static modal(t=null,e={}){let s=h._createTargetContainer();return e.handler&&t.addEventListener("click",e.handler),new C(s,e)}static popover(t,e={}){let s=h._createTargetContainer();return e.handler&&t.addEventListener("click",e.handler),new T(s,t,e)}static msg(t,e={}){let s=h._createTargetContainer();return e.handler&&t.addEventListener("click",e.handler),new I(s,e)}static _createTargetContainer(){let t=document.createElement("div");return t.className="notify-container",t.innerHTML=`
      <div class="notify-header"></div>
      <div class="notify-content"></div>
      <div class="notify-actionbtns"></div>`,t}static _garbage(t){}}class u extends d{constructor(t,e={}){super(t,e.theme||"light"),this.UIType="BaseMsg",this.options={...this.config,...e},this._init()}get config(){return{type:"modal",theme:"light",maxWidth:null,area:["auto","auto"],msgContent:null,customContent:null,msgTitle:"通知",classes:[],placement:"center",confirm:["確認",null],cancel:["取消",null],handler:null,btnList:[]}}_init(){let{type:t,msgTitle:e,icon:s,msgContent:o,customContent:n,btnList:a,confirm:c,cancel:_}=this.options;if(s){let r=this._elem.querySelector(".notify-header"),l=document.createElement("img");l.src=`notify-icons/${s}.svg`,r.appendChild(l)}if(e&&e.toLowerCase()!=="false"){let r=this._elem.querySelector(".notify-header"),l=document.createElement("h3");i.setText(l,e),r.appendChild(l)}if(o){let r=this._elem.querySelector(".notify-content");i.setText(r,o)}if(n){let r=this._elem.querySelector(".notify-content");n instanceof HTMLElement?r.appendChild(n):r.innerHTML+=n}if(a){let r=this._elem.querySelector(".notify-actionbtns");for(let l of a){let f=i.setButtons(l);r.appendChild(f)}}c&&t!=="toast"&&(this.confirm=this._confirmAndcancel(c,"confirm"),this.confirmBtn=this._setBtns(this.confirm)),_&&t!=="toast"&&(this.cancel=this._confirmAndcancel(_,"cancel"),this.cancelBtn=this._setBtns(this.cancel)),this._render()}_render(){let t=this._theme==="dark"?"#1e222789":"#F3F4F6",e=this._theme==="dark"?"#F3F4F6":"#1F2937";i.setProperty(this._elem,"--theme",t),i.setProperty(this._elem,"--text",e),i.setProperty(this._elem,"--maxWidth",this.options.maxWidth),i.setProperty(this._elem,"--w",this.options.area[0]),i.setProperty(this._elem,"--h",this.options.area[1]),this.options.type!=="toast"&&this.options.type!=="popover"&&this._setPosition(this.options.placement)}_confirmAndcancel(t,e){let s=Array.isArray(t)?t:[t],[o,n]=s;return{actionType:e,btnTxt:o,handler:n}}_setBtns(t){const{btnTxt:e,handler:s}=t;let o=this._elem.querySelector(".notify-actionbtns"),n=["btn","btn-primary"];t.actionType!=="confirm"&&n.push("outline-btn");let a=i.setButtons({classes:n,text:e,handler:s});return i.setAttribute(a,`${t.actionType}btn`),o.appendChild(a),a}_setPosition(t){i.setPosition(this._elem,t,["notify-container",...this.options.classes])}}class w extends d{constructor(t){let{transition:e,duration:s,timing:o}=t,n={transition:e||"transition-opacity",duration:s||300,timing:o||"ease-out"},a=h._createTargetContainer(),c=i.setButtons({icon:"close",classes:["text-btn"]});a.querySelector(".notify-header").appendChild(c),super(a,t.theme||"light"),this.UIType="ToastItem",this.style=t.style||"accent",this._base=new u(this._elem,t),this.dismiss=new g(this._elem,c,n),this._init()}_init(){switch(this._base.options.icon?i.setProperty(this._elem,"--style",`var(--${this._base.options.icon})`):i.setProperty(this._elem,"--style","var(--graystyle)"),this.style){case"bordered":i.setAttribute(this._elem,`toast-${this.style}`);break;case"accent":i.setAttribute(this._elem,`toast-${this.style}`);break}this._bindEvent()}_bindEvent(){this.clearItem()}onHide(){this.dismiss.hide()}clearItem(){async function t(){const e=s=>new Promise(o=>{setTimeout(o,s)});await e(5e3),this.dismiss.hide(),await e(2e3),this._elem.remove()}t.bind(this)()}}class p{constructor(t,e){if(t.dataset.toastInit)return p.instances[t.dataset.toastInit];this.options=e,this.trigger=t,this.toastItems=[],this._init(),this.id=`toast-${Date.now()}`,t.dataset.toastInit=this.id,p.instances[this.id]=this}static instances={};_init(){this.toastContainer=document.createElement("div"),i.addClass(this.toastContainer,["toast-container"]),i.setPosition(this.toastContainer,this.options.placement,["toast-container"]),document.body.appendChild(this.toastContainer),new MutationObserver(e=>{e[0].removedNodes.length!==0&&this.clearItem()}).observe(this.toastContainer,{childList:!0})}_bindEvent(){this.options.handler&&this.onevent(this.trigger,"click",this.options.handler),this.onevent(this.trigger,"click",b(this.pushItem,400)),this.clearItem()}pushItem(){let t=new w(this.options),e=document.createDocumentFragment();this.toastItems.push(t),e.appendChild(t._elem),this.toastContainer.appendChild(e)}clearItem(){this.toastItems.shift()}}class C extends d{constructor(t,e){let{backdrop:s,backdropClasses:o,closable:n}=e,a={backdrop:s||"static",backdropClasses:"backdrop "+o||"",closable:n||!1};super(t,e.theme),this.UIType="ModalMsg",this._base=new u(t,e),this.modal=new y(t,a),this._init()}_init(){document.body.append(this._elem),this.onShow(),this._bindEvent(),i.setAttribute(this._elem,"notifymodal")}onShow(){this.modal.show(),i.removeClass(this._elem,["flex"])}onHide(){this.modal.hide(),setTimeout(()=>{this._elem.remove()},3e3)}_bindEvent(){this._base.confirmBtn&&(this.onevent(this._base.confirmBtn,"click",this.onHide.bind(this)),this._base.cancelBtn&&this.onevent(this._base.cancelBtn,"click",this.onHide.bind(this)))}}class T extends d{constructor(t,e,s){let{triggerType:o,offset:n}=s,a={triggerType:o||"click",offset:n||10};super(t,s.theme||"light"),this.UIType="PopoverMsg",this._options={...s,...a},this._base=new u(t,s),this.popover=new v(t,e,a),this._init()}_init(){document.body.append(this._elem),i.setAttribute(this._elem,"notifypopover"),this._bindEvent()}get config(){return this._options}onShow(){this.popover.show()}onHide(){this.popover.hide()}_bindEvent(){let{handler:t}=this._base.confirm;this._base.confirmBtn&&(this.onevent(this._base.confirmBtn,"click",this.onHide.bind(this)),t&&this.onevent(this._base.confirmBtn,"click",t.bind(this)),this._base.cancelBtn&&this.onevent(this._base.cancelBtn,"click",this.onHide.bind(this)))}}class I extends d{constructor(t,e){let{countdown:s}=e;super(t,e.theme||"light"),this.UIType="DefaultMsg",this._options={...this.config,countdown:s},this._base=new u(t,e),this._init()}get config(){return{countdown:1e3}}_init(){document.body.append(this._elem),i.setAttribute(this._elem,"notifymsg"),this._bindEvent(this._options.countdown)}_bindEvent(t){async function e(){const s=o=>new Promise(n=>{setTimeout(n,o)});await s(t),i.addClass(this._elem,["opacity-0"]),await s(1e3),this._elem.remove()}e.bind(this)()}}window.Notification=h;export{h as N};
