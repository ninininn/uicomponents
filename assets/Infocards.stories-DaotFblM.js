import{B as y}from"./Utils-DgnMaxDl.js";import{N as v}from"./Notification-DKVqmcS-.js";import{D as I}from"./Dropdown-DcScMUqx.js";import C from"./CardsAPIdoc-Bb4wZPrh.js";/* empty css                 */import"./index-vRTWSlA6.js";import"./iframe-DIQv53CP.js";import"./preload-helper-DLLWEBaG.js";class k extends y{constructor(e,s){let t=document.createElement("div");t.classList.add("card"),t.innerHTML=` <div class="card-header">
            <div class="data-title">${e}</div>
            <div class="flex flex-row-reverse">
              <button type="button" class="closeBtn btn icon-btn text-btn" data-modal-target="close-data-modal">
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 9-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </button>
              <button type="button" class="miniBtn btn icon-btn text-btn" >
                <svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>

              </button>
            </div>     
        </div>`,super(t),this.UItype="Card",this.cardContainer=this._elem,this.title=e,this._cardsize=this._setCardSize(s),this.minimize=!1,this._bindEvent()}_setCardSize(e){switch(e){case 2:return this.cardContainer.classList.add("md:col-span-2"),"2-col";case 3:return this.cardContainer.classList.add("md:col-span-3"),"full-col";default:return"1-col"}}_bindEvent(){this.onevent(this.cardContainer.querySelector(".miniBtn"),"click",e.bind(this));function e(){this.minimize=!this.minimize,this.cardContainer.dataset.minimize=this.minimize?"mini":"expand";let t=this.minimize?`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 4h4m0 0v4m0-4-5 5M8 20H4m0 0v-4m0 4 5-5"/>
</svg>`:`<svg class="icon text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>`;this.cardContainer.querySelector(".miniBtn").innerHTML=t}this.cardContainer.querySelector(".closeBtn").addEventListener("click",s.bind(this));function s(){v.modal(this.cardContainer.querySelector(".closeBtn"),{msgContent:"確定關閉此資料區塊? 關閉後須重新查詢",placement:"center",confirm:["確定關閉",()=>{this.cardContainer.remove()}],cancel:"取消",backdropClasses:"bg-gray-800/50"})}}}class _ extends k{constructor(e,s,t=1){super(e,t),this._infoStruct=new x(s),this.infoList=this._infoStruct.rows,this.blocks=[],this._contentBlock=document.createElement("div"),this._init()}_createBlock(e){let s=document.createElement("div");if(s.classList.add("row-block"),e.blockId&&(s.id=e.blockId),e.label){let t=document.createElement("div");if(e.blockclass&&t.classList.add(...e.blockclass),Array.isArray(e.label))e.label.forEach((n,a)=>{const r=document.createElement("span");if(r.textContent=n,r.classList.add("card-label"),t.appendChild(r),e.value?.[a]){const i=document.createElement("span");i.textContent=e.value[a],e.valueId?.[a]&&(i.id=e.valueId[a]),t.appendChild(i)}});else{const n=document.createElement("span");if(n.textContent=e.label,n.classList.add("card-label"),t.appendChild(n),e.value){const a=document.createElement("span");a.textContent=e.value,e.valueId&&(a.id=e.valueId),t.appendChild(a)}}e.customInner&&e.customInner.forEach(n=>{if(n instanceof HTMLElement)t.appendChild(n);else{let a=document.createElement("div");a.innerHTML=n,t.appendChild(a)}}),s.appendChild(t)}if(e.customInner&&!e.label&&e.customInner.forEach(t=>{if(t instanceof HTMLElement)e.blockclass&&t.classList.add(...e.blockclass),s.appendChild(t);else{let n=document.createElement("div");n.innerHTML=t,e.blockclass&&n.classList.add(...e.blockclass),s.appendChild(n)}}),e.btn){const t=document.createElement("div");t.classList.add("card-buttons"),e.btngroupClass?t.classList.add(...e.btngroupClass.split(" ")):e.blockclass&&!e.label&&t.classList.add(...e.blockclass),e.btn.forEach(n=>{const a=document.createElement("button");a.classList.add("btn"),a.textContent=n.text,n.class&&a.classList.add(...n.class),n.handler&&a.addEventListener("click",n.handler.bind(this)),n.id&&(a.id=n.id),t.appendChild(a)}),s.appendChild(t)}return s}_init(){this._contentBlock.className="card-data-content",this._render()}_render(){this.clearBlocks();const e=new Map;this.infoList.forEach(s=>{if(s._groupId)e.has(s._groupId)||e.set(s._groupId,[]),e.get(s._groupId).push(s);else{if(s._visible===!1)return;const t=this._createBlock(s);this.blocks.push(t),this._contentBlock.appendChild(t)}}),e.forEach((s,t)=>{const n=document.createElement("div");n.id=t,s.forEach(a=>{if(a._visible===!1)return;const r=this._createBlock(a);n.appendChild(r)}),this._contentBlock.appendChild(n),this.blocks.push(n)}),this.cardContainer.appendChild(this._contentBlock)}addBlocks(e,s={}){this._infoStruct.add(e,s),this.infoList=this._infoStruct.rows,this._render()}clearBlocks(){if(this._contentBlock.children){for(;this._contentBlock.firstChild;)this._contentBlock.firstChild.remove();this.blocks=[]}}deleteBlock(e){this._infoStruct.delete(e),this.infoList=this._infoStruct.rows,this._render()}toggleBlock(e){this._infoStruct.toggle(e),this.blocks.forEach(s=>{s.id===e&&s.classList.add("hidden")})}}class x{constructor(e){this.originInfos=this._wrapInfos(e),this.rowNum=e.length,this.rows=[],this._init()}_init(){this.rows=[];for(let e=0;e<this.rowNum;e++){const s={blockId:this.getInfoKeys("blockId")[e]||null,blockclass:this.getInfoKeys("blockClass")[e]||null,label:this.getInfoKeys("label")[e]||null,value:this.getInfoKeys("value")[e]||null,valueId:this.getInfoKeys("valueId")[e]||null,customInner:this.getInfoKeys("customInner")[e]||[],btn:Array.isArray(this.getInfoKeys("btn"))?this.getInfoKeys("btn")[e]:this.getInfoKeys("btn"),btngroupClass:this.getInfoKeys("btngroupClass")[e]};this.rows.push(s)}}_wrapInfos(e){return{blockId:e.map(t=>t.blockId||""),label:e.map(t=>t.label||""),blockClass:e.map(t=>t.blockclass||""),value:e.map(t=>t.value||""),valueId:e.map(t=>t?.valueId||""),customInner:e.map(t=>t.customInner?Array.isArray(t.customInner)?t.customInner:[t.customInner]:[]),btn:e.map(t=>t.btn),btngroupClass:e.map(t=>t.btngroupClass)}}getInfoKeys(e){return this.originInfos[e]}add(e,{once:s=!1,id:t}={}){const n=this._wrapInfos(e),a=e.map((r,i)=>({blockId:r.blockId||null,blockclass:n.blockClass[i]||null,label:n.label[i]||null,value:n.value[i]||null,valueId:n.valueId[i]||null,customInner:n.customInner[i]||null,btn:Array.isArray(n.btn)?n.btn[i]:n.btn,btngroupClass:n.btngroupClass[i],_groupId:t||null}));if(s){if(!t){console.error("once 模式需要提供 id");return}this.rows=this.rows.filter(r=>r._groupId!==t)}this.rows.push(...a),this.originInfos=this._wrapInfos(this.rows),this.rowNum=this.rows.length}delete(e){let s=this.getInfoKeys("label").findIndex(t=>t.includes(e));if(s<0){if(s=this.getInfoKeys("blockId").findIndex(t=>t===e),s<0){console.error("沒有對應的block");return}}else if(Array.isArray(this.getInfoKeys("label")[s])){let t=this.getInfoKeys("label")[s].findIndex(n=>n.includes(e));this.getInfoKeys("label")[s]=this.getInfoKeys("label")[s].filter((n,a)=>a!==t),this.getInfoKeys("value")[s]=this.getInfoKeys("value")[s].filter((n,a)=>a!==t),this.getInfoKeys("label")[s].length===1?(this.getInfoKeys("label")[s]=this.getInfoKeys("label")[s].toString(),this.getInfoKeys("value")[s]=this.getInfoKeys("value")[s].toString(),this.rows[s].label=this.getInfoKeys("label")[s],this.rows[s].value=this.getInfoKeys("value")[s]):(this.rows[s].label=this.getInfoKeys("label")[s].filter((n,a)=>a!==t),this.rows[s].value=this.getInfoKeys("value")[s].filter((n,a)=>a!==t))}else{for(let t in this.originInfos)this.originInfos[t]=this.originInfos[t].filter((n,a)=>a!==s);this.rowNum=this.rowNum-1,this.rows=this.rows.filter((t,n)=>n!==s)}console.log("after delete:",this.originInfos)}clear(){this.originInfos={},this.rowNum=0,this.rows=[]}toggle(e){this.rows.forEach(s=>{s._visible,s._groupId===e&&(s._visible=!1)})}}class E{constructor({labels:e,legends:s}){this.labels=e,this.legends=s,this.container=document.createElement("div"),this._init()}_init(){this.entries=Object.fromEntries(this.labels.map((e,s)=>[e,this.legends[s]])),this._render()}_render(){for(let e in this.entries){let s=document.createElement("div"),t=document.createElement("span"),n=document.createElement("p");n.textContent=e,t.classList.add("inline-block","w-6","h-5","border-gray-700"),t.classList.add(this.entries[e]),s.classList.add("flex","gap-2","items-center"),s.appendChild(t),s.appendChild(n),this.container.appendChild(s)}}}new E({labels:["a","b","c"],legends:["bg-red-700","bg-green-500","bg-blue-500"]});const L=({blockId:l,blockclass:e,label:s,value:t,customInner:n,title:a,cardSize:r,btn:i,text:u,handlers:h,btngroupClass:p,...m})=>{const b=new I("ex_drop",[{value:1,text:"One"},{value:2,text:"Two"},{value:3,text:"Three"}]);function g(){alert("查看更多 clicked!")}let c=document.createElement("div");c.className="grid grid-cols-3",i=[{text:u,class:m.class,handlers:h}];let f=[{blockId:l,blockclass:[...e],label:[s,"price: "],value:[t,"$1,000"],customInner:n,btn:i,btngroupClass:p},{blockclass:["mt-3"],label:"配合其他元件作為customInner :",customInner:b.containerEl},{btn:[{text:"查看更多",class:["btn-primary"],handler:g}],btngroupClass:"mt-3"}],d=new _(a,f,r);return c.appendChild(d.cardContainer),console.log("realpriceCard:",d),c},{fn:N,expect:H}=__STORYBOOK_MODULE_TEST__,{action:O}=__STORYBOOK_MODULE_ACTIONS__,D={title:"Components/Infocards",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:C}},render:({...l})=>L({...l}),argTypes:{cardSize:{control:"select",options:[1,2,3],description:"卡片尺寸大小",table:{category:"parameters",subcategory:"Inherits Card 類別",defaultValue:{summary:"1"},type:{summary:"number"}}},infoList:{control:"array",description:"傳入之資料欄位設定，請參考上方Info porperties",table:{readonly:!0,category:"parameters",subcategory:"Inherits Info 類別",type:{summary:"array"}}},title:{control:"text",description:"卡片標題文字",table:{category:"parameters",subcategory:"Inherits Card 類別",type:{summary:"string"}}},blockId:{control:"text",description:"區塊指定id",table:{category:"infoList poperties",type:{summary:"string"}}},blockclass:{control:"array",description:"區塊classes",table:{category:"infoList poperties",type:{summary:"array"}}},label:{control:"text",description:"資料標題",table:{category:"infoList poperties",type:{summary:"string"}}},value:{control:"text",description:"資料內容",table:{category:"infoList poperties",type:{summary:"string"}}},customInner:{control:"text",description:"自訂innerHTML內容，可以取代value屬性",table:{category:"infoList poperties",type:{summary:"string"}}},btn:{control:"function",description:"所有按鈕設定",table:{readonly:!0,category:"infoList poperties",type:{summary:"array"}}},text:{control:{type:"text"},if:{arg:"btn",exists:!0},description:"按鈕文字",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"string"}}},class:{control:{type:"array"},if:{arg:"btn",exists:!0},description:"checkbox classes，每個class以tailwindcss property放入",table:{category:"infoList poperties",subcategory:"btn",type:{summary:"array"}}},handlers:{action:"change",control:"function",if:{arg:"btn",exists:!0},description:"作為click事件函式傳入",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"function"}}},btngroupClass:{control:"text",description:"按鈕群組樣式(如果沒有特別設定則是吃blockClass)",table:{category:"infoList poperties",subcategory:"btn",defaultValue:{summary:"null"},type:{summary:"string"}}}},args:{label:"資料欄位A",value:"資料A"}},o={args:{blockId:"testing",blockclass:["gap-3"],label:"資料欄位A: ",value:"資料內容A",customInner:'<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>',title:"測試面板",cardSize:1,btn:[],text:"開始查詢",class:["btn-secondary"],btngroupClass:"flex flex-nowrap ml-2"}};o.parameters={...o.parameters,docs:{...o.parameters?.docs,source:{originalSource:`{
  args: {
    blockId: "testing",
    blockclass: ["gap-3"],
    label: "資料欄位A: ",
    value: "資料內容A",
    customInner: \`<div class="border-2 border-gray-400 rounded-sm p-2">自訂義區塊</div>\`,
    title: "測試面板",
    //文字
    cardSize: 1,
    btn: [],
    text: "開始查詢",
    class: ["btn-secondary"],
    btngroupClass: "flex flex-nowrap ml-2"
  }
  // play: async ({ args, canvas, userEvent }) => {
  //   await userEvent.type(canvas.getByText('一般勾選框'), '勾選框');
  //   await userEvent.click(canvas.getByLabelText('一般勾選框'));
  //   await expect(args.handlers).toHaveBeenCalled();
  // }
}`,...o.parameters?.docs?.source}}};const F=["defaultInfocard"];export{F as __namedExportsOrder,D as default,o as defaultInfocard};
