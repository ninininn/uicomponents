import{B as p,d as V,c as g,D as n}from"./Utils-DOz9aA_P.js";import E from"./SliderAPIdoc-ypXuAhW-.js";import"./iframe-DpQgjgPA.js";import"./preload-helper-DLLWEBaG.js";class T extends p{constructor(...e){const{element:s,options:r}=V(e,"div"),i=r.disabled?"var(--color-gray-500)":r.theme||"var(--color-yellow-500)";super(s,i),this.UItype="Slider",this.options={...this._defaultOptions,...r},this.disabled=this.options.disabled,this.defaultTheme=r.theme||i,this._draggingIndex=null,this.onPointerMove=this._onPointerMove.bind(this),this.onPointerUp=this._onPointerUp.bind(this),this._checkRange();const[l,a,t]=g(this.options.initValue);this.getValue=l,this.setValue=a,this.subscribeValue=t;const[o,y,f]=g(i);if(this.getTheme=o,this.setTheme=y,this.subscribeTheme=f,this.options.handlers&&(this.handlers=this.options.handlers),this.bar=new S(this.getValue(),this.subscribeValue,this._theme,this.subscribeTheme),this.options.range){let b=this.getValue();this.thumb=[new c(b[0],this.subscribeValue,this.options.thumbImg,this._theme,this.subscribeTheme,0),new c(b[1],this.subscribeValue,this.options.thumbImg,this._theme,this.subscribeTheme,1)],this.childrens=[...this.thumb.map(_=>_.getElem()),this.bar.getElem()]}else this.thumb=new c(this.getValue(),this.subscribeValue,this.options.thumbImg,this._theme,this.subscribeTheme),this.childrens=[this.thumb.getElem(),this.bar.getElem()];this._init()}get _defaultOptions(){return{min:0,max:100,initValue:0,step:1,input:!1,range:!1,theme:"var(--color-yellow-500)",thumbImg:null,classes:["slider"],handlers:null,disabled:!1}}_init(){this.render();for(let e of this.childrens)this.getElem().appendChild(e);this._bindEvents(),this.setDisabled(this.disabled)}render(){this._checkRange(),n.addClass(this.getElem(),this.options.classes),this.options.range&&n.setAttribute(this.getElem(),"slider","range"),this.disabled?n.addClass(this.getElem(),["disabled"]):n.removeClass(this.getElem(),["disabled"])}changeTheme(e){this.setTheme(e),super.setTheme(e)}setDisabled(e){this.disabled=e,this.changeTheme(this.disabled?"var(--color-gray-500)":this.defaultTheme),this._updateDisabled()}_onPointerDown(e,s){e.preventDefault(),this._draggingIndex=s,this.onevent(e.currentTarget,"pointermove",this.onPointerMove),this.onevent(e.currentTarget,"pointerup",this.onPointerUp)}_onPointerMove(e){e.preventDefault(),this._draggingIndex!==null&&this._setPointValue(e)}_onPointerUp(e){this.draggingIndex=null,this.offevent(e.currentTarget,"pointermove",this.onPointerMove),this.offevent(e.currentTarget,"pointerup",this.onPointerUp)}_bindEvents(){(this.options.range?this.thumb:[this.thumb]).forEach((e,s)=>{const r=i=>{i.currentTarget.setPointerCapture(i.pointerId),this._onPointerDown(i,s)};this.onevent(e.getElem(),"pointerdown",r)}),this.onevent(this.bar.getElem(),"pointerdown",this._setPointValue.bind(this))}_setPointValue(e){const s=this.getValue(),r=this.getElem().getBoundingClientRect(),i=(e.clientX-r.left)/r.width*100,l=Math.round(i/this.options.step)*this.options.step;let a=Math.min(this.options.max,Math.max(0,l));if(a<this.options.min&&(a=this.options.min),this.options.range){const t=[...s];t[this._draggingIndex]=a,t[0]>t[1]&&t.reverse(),this.setValue(t)}else this.setValue(a);this.handlers&&this.handlers(this.getValue())}_checkRange(){const{initValue:e,range:s,min:r,max:i}=this.options;s?this.options.initValue=Array.isArray(e)?e:[e,i]:this.options.initValue=Array.isArray(e)?e[0]:e}_updateDisabled(){this.disabled?(super.destroy(),n.addClass(this.getElem(),["disabled"])):(this._bindEvents(),n.removeClass(this.getElem(),["disabled"]))}}class c extends p{constructor(e,s,r=null,i,l,a=0){const t=document.createElement("div");super(t,i),this._thumbIndex=a,this._thumbValue=Array.isArray(e)?e[a]:[e],this._thumbImg=r,this._init(),s(o=>{o=Array.isArray(o)?o[a]:o,this._setThumbValue(o)}),l(o=>{super.setTheme(o)})}_init(){this.render()}render(){n.addClass(this.getElem(),["slider-thumb"]),n.setProperty(this.getElem(),"--bgColor",this._theme),this._thumbImg&&(this.getElem().style.setProperty("--tmb-img",`url(${this._thumbImg})`),n.addClass(this.getElem(),["custom-thumb"]))}_setThumbValue(e){this._thumbValue=e;let s=5;this.getElem().style.left=`${e-s}%`}}class S extends p{constructor(e,s,r,i){const l=document.createElement("div"),a=document.createElement("span");a.classList.add("mask"),super(l,r),this.mask=a,this._barValue=e,this.startValue=e[0],this.options={...this.defaultOptions},this._init(),s(t=>{this.startValue=t[0]??t,t=Array.isArray(t)?t[1]-t[0]:t,this._setBarValue(t)}),i(t=>{super.setTheme(t)})}get defaultOptions(){return{classes:["slider-bar"]}}_init(){this.render(),this.getElem().appendChild(this.mask)}render(){n.addClass(this.getElem(),this.options.classes),n.setProperty(this.mask,"--bgColor",this._theme)}_setBarValue(e){this._barValue=e,this.mask.style.setProperty("--slider-width",`${e}%`),this.mask.style.setProperty("--start-point",`${this.startValue}%`)}}const C=h=>new T(h),{fn:v}=__STORYBOOK_MODULE_TEST__,{action:x}=__STORYBOOK_MODULE_ACTIONS__,A={title:"Components/Slider",tags:["autodocs"],parameters:{docs:{source:{format:!0,language:"html"},page:E}},render:({...h})=>{let e=document.createElement("div");e.classList.add("w-70");let s=C({...h});return e.appendChild(s.getElem()),e},argTypes:{handlers:{action:"callback",control:"function",description:"callback function，可以取用 slider value",table:{category:"options parameter",defaultValue:{summary:"null"},type:{summary:"function"}}},initValue:{control:"number",description:"初始值，如果有開啟range功能則傳入Array",table:{category:"options parameter",defaultValue:{summary:"0"},type:{summary:"number | array"}}},range:{control:"boolean",description:"控制雙向slider功能",table:{category:"options parameter",defaultValue:{summary:"false"},type:{summary:"boolean"}}},thumbImg:{control:{type:"file"},description:"客製thumb圖示，可以放入圖片路徑來使用",table:{category:"options parameter",defaultValue:{summary:"null"},type:{summary:"/path-to-img.png"}}},step:{control:{type:"number"},table:{category:"options parameter",defaultValue:{summary:"1"},type:{summary:"number"}}},theme:{control:{type:"color",presetColors:["var(--color-yellow-500)"]},description:"Slider主題色，可以傳入css variables 或是 HEX 色碼",table:{category:"options parameter",subcategory:"Inherits BaseComponent",defaultValue:{summary:"var(--color-yellow-500)"},type:{summary:"string"}}},min:{control:{type:"number"},table:{category:"options parameter"}},max:{control:{type:"number"},table:{category:"options parameter"}},disabled:{control:"boolean",description:"是否為disabled狀態，可以搭配Checkbox元件(傳入checked值)使用",table:{category:"options parameter",defaultValue:{summary:"false"},type:{summary:"boolean"}}}},args:{handlers:x("getValue")}},m={args:{initValue:30,range:!1,step:1,disabled:!1,theme:"#8bd7bb",min:1,max:100}},d={args:{initValue:30,range:!1,step:1,disabled:!1,theme:"#8bd7bb",min:1,max:100,thumbImg:"/sticker.png"}},u={args:{initValue:[24,64],range:!0,step:1,disabled:!1,theme:"#8bd7bb",min:1,max:100}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  args: {
    initValue: 30,
    range: false,
    step: 1,
    disabled: false,
    theme: '#8bd7bb',
    min: 1,
    max: 100
  }
}`,...m.parameters?.docs?.source}}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    initValue: 30,
    range: false,
    step: 1,
    disabled: false,
    theme: '#8bd7bb',
    min: 1,
    max: 100,
    thumbImg: '/sticker.png'
  }
}`,...d.parameters?.docs?.source}}};u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:`{
  args: {
    initValue: [24, 64],
    range: true,
    step: 1,
    disabled: false,
    theme: '#8bd7bb',
    min: 1,
    max: 100
  }
}`,...u.parameters?.docs?.source}}};const O=["defaultSlider","customSlider","rangeSlider"];export{O as __namedExportsOrder,d as customSlider,A as default,m as defaultSlider,u as rangeSlider};
